<!--{{/*

    USAGE:

    {{< jsvis-map "COLOR CODE HERE" >}}

*/}}-->  

<!--{{/*  Importing external scripts*/}} */}}-->
<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script>
  if (!window.vis) {
    document.write('<script src="https://cdn.jsdelivr.net/npm/vis-network@latest/standalone/umd/vis-network.min.js"><\/script>');
  }
</script>
<script>
  if (!window.vis) {
    document.write('<script src="/js/vis-network.min.js"><\/script>');
  }
</script>


<!--{{/*  ************************************************************* */}}-->
<!--{{/*  REMOVE BELOW LINES TO REBUILD A STANDALONE HTML FILE */}}-->  

<script>
    var outlineText = "\n" + `{{ trim .Inner "\n\r " }}`  + "\n";
    // Default to Italian Google for Italian pages
    window.googleSearchDomain = 'it';
</script>

{{ $css := resources.Get "css/jsvisMapStyle.css" }}
<link href="{{ $css.RelPermalink }}" rel="stylesheet">

<style>#mynetwork {background-color: {{ .Get 0 }};background-image: url({{ .Get 1 }});}</style>

{{ $js := resources.Get "js/jsvisMap.js" }}
{{ $js := $js | minify | fingerprint }}
<script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}"></script>

{{ $jso := resources.Get "js/jsvisMapOptions.js" }}
{{ $jso := $jso  | fingerprint }}
<script src="{{ $jso.RelPermalink }}" integrity="{{ $jso.Data.Integrity }}"></script>

<!--{{/*  REMOVE ABOVE LINES TO REBUILD A STANDALONE HTML FILE */}}--> 
<!--{{/*  ************************************************************* */}}-->

<!--{{/*  ************************************************************* */}}-->
<!--{{/*  INSERT BELOW LINES TO REBUILD A STANDALONE HTML FILE */}}-->  

<!--{{/*  
var outlineText = MAP OUTLINE STRING
<link href="jsvisMapStile.css" rel="stylesheet">
<style>#mynetwork {background-color: COLOR CODE HERE; background-image: url(IMAGE URL HERE);}</style>
<script src="/js/jsvisMap.js"></script>
<script src="/js/jsvisMapOptions.js"></script>
*/}}-->  

<!--{{/*  INSERT ABOVE LINES TO REBUILD A STANDALONE HTML FILE */}}--> 
<!--{{/*  ************************************************************* */}}-->


{{/*  NEXT LINE TO BE UNCOMMENTED FOR STANDALONE HTML FILE  */}}
{{/*  <h3 class="titleMap">Jsvis SpaceQuest</h3>  */}}

<div>

<details style=" margin: 0rem; text-align: left; padding: 0.3rem; text-align: justify; border-radius: 5px;">
    <summary id="help">
        Clicca qui per le istruzioni
    </summary>
    <ul>
        <li>‚ë† ‚û° üáÆüáπ IT / üá¨üáß EN seleziona il dominio Google (i termini restano in italiano; per termini inglesi usa la versione EN del sito)</li>
        <li>‚ë° ‚û° seleziona le opzioni di ricerca dalla casella a sinistra</li>
        <li>‚ë¢ ‚û° usa lo zoom della mappa con la rotella del mouse</li>
        <li>‚ë£ ‚û° clicca sullo spazio vuoto tra i nodi per spostare la mappa, </li>
        <li>‚ë§ ‚û° RESET (pi√π volte se necessario) o trascina i nodi per migliorare il layout</li>        
        <li>‚ë• ‚û° passa il mouse sopra il nodo per la stringa web; clicca per le connessioni; doppio clic per la ricerca</li>
        <li>‚ë¶ ‚û° <a href="https://www.freecodecamp.org/news/how-to-google-like-a-pro-10-tips-for-effective-googling/" target="_blank" >regola la stringa di ricerca ‚Üó</a> nella SERP in base alle tue esigenze</li>
    </ul>
    </details>



<div id= "allMap" style="position: relative">
    <div id="selectoptions">
        <!-- Search Options -->
        <div id="searchOptions" style="font-family: Arial; font-size:13px;">
            <p style="color:darkred ; font-size:.7rem; font-weight: bold; text-align:center">Google Search</p>
            <!-- Language Toggle -->
            <div id="langToggle" style="text-align:center; margin-bottom:0.3rem;">
                <button id="langItBtn" class="lang-btn lang-active" onclick="setSearchLang('it')" style="padding:2px 8px; font-size:11px; cursor:pointer;">üáÆüáπ IT</button>
                <button id="langEnBtn" class="lang-btn" onclick="setSearchLang('com')" style="padding:2px 8px; font-size:11px; cursor:pointer;">üá¨üáß EN</button>
            </div>
            <input type="radio" id="allBtn" name="options" value="pdf" checked="checked">
            <label for="allBtn">Tutto</label><br>
            <input type="radio" id="pdfBtn" name="options" value="pdf">
            <label for="pdfBtn">PDF</label><br>
            <input type="radio" id="newsBtn" name="options" value="news">
            <label for="newsBtn">News</label><br>
            <input type="radio" id="bookBtn" name="options" value="book">
            <label for="bookBtn">Libri</label><br>
            <input type="radio" id="videoBtn" name="options" value="video">
            <label for="videoBtn">Video</label><br>
            <input type="radio" id="scholarBtn" name="options" value="scholar">
            <label for="scholarBtn">Scholar</label><br>

            {{/*  {{ if .Page.Draft }}  */}}
            <hr style="margin:.2rem; background:navy;">
            <input type="radio" id="consultBtn" name="options" value="consult">
            <label for="consultBtn">Consultants</label><br>
            <input type="radio" id="agenciesBtn" name="options" value="agencies">
            <label for="agenciesBtn">Agencies</label><br>
            <hr style="margin:.2rem; background:navy;">
            <p style="color:darkred ; font-size:.7rem; font-weight: bold;margin-bottom:0; padding-top:1rem; text-align:left">Exa Search</p>
            <input type="radio" id="ExaBtn" name="options" value="e-all">
             <label for="ExaBtn">Tutto</label><br>
            {{/*  
            <input type="radio" id="ExaCompanyBtn" name="options" value="e-company">
            <label for="ExaBtn">Company</label><br>
            <input type="radio" id="ExaResearchPaperBtn" name="options" value="e-research">
            <label for="ExaBtn">Papers</label><br>
            <input type="radio" id="ExaBlogPostBtn" name="options" value="e-blog">
            <label for="ExaBtn">Blog</label><br>
            <input type="radio" id="ExaNewsBtn" name="options" value="e-news">
            <label for="ExaBtn">News</label><br>
            */}}

            {{/*  {{ end }}  */}}

        </div>
        <!-- Date Inputs -->
        <div id="dates">
            da <input type="date" id="startDate" style="font-size:11px;">
            a <input type="date" id="endDate" style="font-size:11px">
        </div>
        <!-- <button id="initialView" onClick="window.location.reload();">initial viewüñ±Ô∏è</button> -->
        <div id="initialView" style="background-color:white" onClick="reloadDiv();">RESET üñ±Ô∏è</div>
    </div>
  

    <div id="mynetwork"></div>

    <div class="footermap">
        powered by <a href=https://visjs.org/ target=_blank rel="noopener noreffer"
            title="visjs.org">visjs.org</a> | The SpaceQuest¬© Map¬© 2025-2030 | cesare sodi's production | <a
            rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/
            target=_blank> CC BY-NC 4.0</a>
    </div>

</div>
</div>

<script>
    function reloadDiv() {
        // Just call the functions to recreate the map
        setDefaultSearchOptions();
        var network = createNetwork(data, options);
        network.moveTo({ scale: mapScale });
        handleNetworkInteractions(network, nodes, rootId);
    }

    // Language toggle for Google search domain
    function setSearchLang(domain) {
        window.googleSearchDomain = domain;
        // Update button styles
        document.getElementById('langItBtn').classList.toggle('lang-active', domain === 'it');
        document.getElementById('langEnBtn').classList.toggle('lang-active', domain === 'com');
    }
</script>

<style>
    .lang-btn { background: #f0f0f0; border: 1px solid #ccc; border-radius: 3px; }
    .lang-btn.lang-active { background: #4a90d9; color: white; border-color: #357abd; }
</style>

<script type="text/javascript">
    let rootId = 1; // id number of central node
    if (positionAcquired === true) {
        updateNodePositions(nodes, positions);
    }

    if (colorStyle === "default") {
        updateNodeColors(nodes, edges, rootId);
    } else if (colorStyle === "palette") {
        paletteNodeColors(nodes);
    }

    setDefaultSearchOptions();

    var network = createNetwork(data, options);

    network.moveTo({ scale: mapScale })

    handleNetworkInteractions(network, nodes, rootId);

</script>
